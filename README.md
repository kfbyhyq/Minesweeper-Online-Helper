# Minesweeper Online Helper 在线扫雷网（WoM）助手

基于Chrome内核浏览器的WoM (https://minesweeper.online/) 插件，用于统计游戏数据。

## 如何使用

插件GitHub主页 -> **<>code** -> **Download ZIP**

下载的压缩包解压到任意位置

浏览器 -> **扩展** -> **管理扩展** -> 打开**开发人员模式** -> **加载解压缩的扩展** -> 选择解压后的文件夹

每次更新后直接覆盖文件夹内所有文件即可，无需修改文件夹名

如果在浏览器中卸载插件重新安装会丢失所有数据，建议提前在**设置**页**备份数据**

使用时建议先打开**插件主页** -> **设置** -> 设置**当前登录账号uId**

## 插件弹出页

在浏览器插件栏点击插件图标可以打开插件弹出页，各按钮在可使用的页面会变为蓝色并可点击，作用分别为：

1. 打开主界面：打开插件主页

2. 刷新宝石/场币/碎片价格：在网站**市场**首页（即分类选全部，如果不是会跳转）采集所有宝石、竞技场币、碎片的最低市场价，然后会跳转到完美碎片页提取每种完美碎片的最低价；采集任何数据时需要保证插件弹出页和插件主页至少有一个为打开状态才能成功收集，下同

3. 刷新竞技场门票价格：在网站**市场**页采集所有竞技场门票的最低市场价，比较慢，等待按键变绿为成功

4. 刷新装备加成：在网站**装备**页采集当前装备加成情况

5. 刷新游戏数据：在网站**数据统计**页勾选**我的数据**时，采集当前账号游戏数据

6. 刷新个人数据：在网站**我的主页**页采集当前页面账号奖杯、装备、资源数据。（可以在他人主页生效，但会覆盖个人数据）

7. 刷新财产估值：在网站**商店**->**游戏经济**页采集今日财富估值

8. 添加好友：在任意用户主页将该账号加入好友列表

9. 统计我的游戏：在网站**我的游戏**页，任选筛选条件后统计当前列表中列出的游戏信息，下载到一个.csv文件中（其中会包括未完成的游戏），并保存在插件数据中（不包括未完成的游戏）；在页数多时速度较慢，除第一次提取外，可以只覆盖新增对局，如提取当月数据；保存数据会去重，无须担心重复

10. 统计我的游戏（500）页：同上，提取从当前活跃页起500页内的数据，以避免页数过多卡死的情况

11. 刷新活动门票价格：只在活动门票月生效，在网站**市场**页采集所有活动竞技场门票的最低市场价

12. 刷新友谊任务：只在友谊任务月生效，在网站**活动任务**页采集**发送任务**、**收到的任务**、**已发送的任务**各自当前页中的任务信息，提取多页需要翻页后再次点击

13. 刷新友谊任务列表：只在友谊任务月生效，在网站**活动任务**页采集**发送任务**、**收到的任务**、**已发送的任务**所有页中的任务信息

14. 刷新活动任务：只在全球任务月生效，在网站**活动任务**页根据近期任务分析下一个任务的信息

## 插件主页

1. 游戏数据

    显示最近一次采集的游戏数据；根据历史数据计算每日增量。如果两天之间的若干天没有采集，后一天显示的数据是这些天数据之和

    - 打开我的数据统计：打开网站**数据统计**页并勾选**我的数据**

    - 刷新游戏数据：后台打开网站**数据统计**页（勾选**我的数据**）提取我的游戏数据后自动关闭，效果等同插件弹出页的*刷新游戏数据*

2. 当前市价

    显示最近一次采集到的市场最低价等信息

    - 打开市场页：打开网站**市场**页

    - 刷新价格：后台打开网站**市场**页提取宝石/场币/碎片市场最低价后自动关闭，效果等同插件弹出页的*刷新宝石/场币/碎片价格*

    - 查看拆解收益：选择装备质量后显示各种装备拆解碎片估价与制造估价之差；拆解碎片价为拆解碎片数乘以碎片市场最低价，制造估价根据对应宝石和场币的市场最低价计算；需要提取过宝石/场币/碎片市场最低价才能计算；再次点击收起

    - 打开竞技场页：打开网站**竞技场**页

    - 刷新票价：前台打开网站**市场**页依次提取每一种竞技场门票市场最低价后自动关闭，效果等同插件弹出页的*刷新竞技场门票价格*；时间较久请耐心等待（速度取决于页面加载速度），可在设置中选择后台提取，会更慢

    - 竞技场门票收益参考：见文字说明

3. 历史价格

    根据插件每天采集到的市场价，显示历史价格比较；如果出现异常数据可以手动修改单个数据

4. 个人数据

    显示最近一次采集到的个人资源、装备加成、财产数据等；根据历史数据展示奖杯变化里程碑
    
    - 打开我的主页：打开网站**我的主页**

    - 刷新个人数据：后台打开网站**我的主页**提取个人数据后自动关闭，效果等同插件弹出页的*刷新个人数据*

    - 展开每日资源变化：在宝石和场币明细后显示每日宝石、场币、金币和功勋的变化，需要有至少两天的资源数据才能显示，再次点击收起

    - 打开装备页：打开网站**装备**页

    - 刷新装备加成：后台打开网站**装备**页提取装备加成状态后自动关闭，效果等同插件弹出页的*刷新装备加成*

    - 打开游戏经济页：打开网站**商店**->**游戏经济**页

    - 刷新财产估值：后台打开网站**商店**->**游戏经济**页提取我的财富数据后自动关闭

    - 展开每日财产变化：显示各类资源的财产估价变化，除了总财产为具体估值外其他类别只有大致结果；再次点击收起

5. 活动商店

    根据当前市场最低价，计算兑换不同项目时活动物品相当于多少金币

    完美线指为了达到第一列的目标活动物品，平均每日需要获得多少活动物品、当日应该达到多少活动物品、根据当前活动物品值剩余每日需要获得多少活动物品

    - 打开活动页：打开网站**活动**页

6. 完美装备

    根据当前价格和资源，展示制作完美装备的信息；估价：制造装备所需金币、宝石、场币总价（按市场最低价）；宝石花费：根据当前拥有的宝石数，还需要花费多少金币购买宝石；场币花费：根据当前拥有的场币数，还需要花费多少金币购买场币；总花费：根据当前拥有的资源，总计还需要多少金币

    - 打开装备页：打开网站**装备**页

7. 活动竞技场

    只在活动竞技场月可用，显示最近一次采集到的活动竞技场门票市场最低价，以及历史价格变化

    - 手动刷新价格：点击*最低价*行可手动输入价格，点击*手动刷新价格*保存
    
    - 自动刷新价格：后台打开网站**市场**页自动提取活动竞技场门票市场最低价并关闭，效果等同插件弹出页的**刷新活动门票价格**

8. 友谊任务

    只在友谊任务月可用，显示本月友谊任务累计、每日统计信息
    
    - 打开友谊任务页：打开网站**活动任务**页

    - 刷新五页：后台打开网站**活动任务**页并提取待发送任务、收到任务和已发送任务各自前五页的任务信息

    - 刷新全部：后台打开网站**活动任务**页并提取待发送任务、收到任务和已发送任务中的全部任务信息

    提取任务会去重，无需担心重复；如果有用户修改了昵称，刷新全部可以更新所有昵称数据

    - 修改昨日活跃度：为了保证昨日活跃度正确计算，尽量在每日最后一次游戏后刷新友谊任务数据或设置定时自动刷新，如果最后一次采集到的活跃度不正确，可以在此手动修改

9. 全球任务

    只在全球任务月可用，根据已有全球任务分析下一个任务的信息
    
    - 活动任务分析：后台打开**活动任务**页分析任务信息并自动关闭，效果等同插件弹出页的**刷新活动任务**

    - 打开活动任务页：打开网站**活动任务**页

10. 刷新数据

    刷新所有数据，效果等同于同时点击**刷新游戏数据**、**刷新价格**、**刷新票价**、**刷新个人数据**、**刷新装备加成**、**刷新财产估值**、活动竞技场的**自动刷新价格**（如果在活动竞技场月）、友谊任务的**刷新五页**（如果在友谊任务月）

11. 设置

    设置账号uid、估价相关参数、自动刷新、竞技场用时系数、备份数据和恢复备份
    
    自动刷新需保持浏览器中插件主页打开，自动刷新和**刷新数据**的区别在于前者在友谊任务月会触发**刷新全部**而后者会触发**刷新五页**
    

